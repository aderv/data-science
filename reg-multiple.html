<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Ciencia de Datos - 5&nbsp; Regresión lineal múltiple</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./reg-simple.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JBLWWCLEGX"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JBLWWCLEGX', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles/global.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./reg-simple.html">Regresión Lineal</a></li><li class="breadcrumb-item"><a href="./reg-multiple.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresión lineal múltiple</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Ciencia de Datos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentación</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Análisis Exploratorio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción al uso de <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./uso-ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Uso de <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./uso-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Uso de <code>dplyr</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Regresión Lineal</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg-simple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresión lineal simple</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg-multiple.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresión lineal múltiple</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#estimación-de-los-parámetros" id="toc-estimación-de-los-parámetros" class="nav-link active" data-scroll-target="#estimación-de-los-parámetros"><span class="header-section-number">5.1</span> Estimación de los parámetros</a></li>
  <li><a href="#valor-esperado-y-varianza" id="toc-valor-esperado-y-varianza" class="nav-link" data-scroll-target="#valor-esperado-y-varianza"><span class="header-section-number">5.2</span> Valor esperado y Varianza</a></li>
  <li><a href="#predicción" id="toc-predicción" class="nav-link" data-scroll-target="#predicción"><span class="header-section-number">5.3</span> Predicción</a></li>
  <li><a href="#inferencia" id="toc-inferencia" class="nav-link" data-scroll-target="#inferencia"><span class="header-section-number">5.4</span> Inferencia</a></li>
  <li><a href="#pruebas-de-significancia" id="toc-pruebas-de-significancia" class="nav-link" data-scroll-target="#pruebas-de-significancia"><span class="header-section-number">5.5</span> Pruebas de significancia</a></li>
  <li><a href="#uso-de-r-para-los-cálculos" id="toc-uso-de-r-para-los-cálculos" class="nav-link" data-scroll-target="#uso-de-r-para-los-cálculos"><span class="header-section-number">5.6</span> Uso de <code>R</code> para los cálculos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresión lineal múltiple</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="estimación-de-los-parámetros" class="level2 page-columns page-full" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="estimación-de-los-parámetros"><span class="header-section-number">5.1</span> Estimación de los parámetros</h2>
<div class="page-columns page-full"><p>Recuerde que el modelo general es <span class="math display">\[y_i = f(x_i) + \varepsilon_i\]</span> Y lo hemos reducido al caso muy especial de regresión lineal simple <span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\]</span> La generalización natural de este modelo es <span class="math display">\[y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} +...+ \beta_p x_{ip} + \varepsilon_i\]</span> que se llama modelo de regresión lineal múltiple. En este caso, tenemos <span class="math inline">\(p\)</span> variables y <span class="math inline">\(p+1\)</span> parámetros<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;algunos textos consideran <span class="math inline">\(p\)</span> como el número de parámetros</p></li></div></div>
<p>El modelo con múltiples variables se puede escribir de forma concisa usando notación matricial</p>
<p><span class="math display">\[\bf{y} = \bf{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon}\]</span> Donde <span class="math display">\[\bf{y} = \begin{bmatrix}
y_1 \\ y_2 \\ \vdots \\ y_n
\end{bmatrix}, \hspace{10pt}
\bf{X} = \begin{bmatrix}
1 &amp; x_{11} &amp; \dots &amp; x_{1p} \\
1 &amp; x_{21} &amp; \dots &amp; x_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{n1} &amp; \dots &amp; x_{np} \\
\end{bmatrix}, \hspace{10pt}
\boldsymbol{\beta} = \begin{bmatrix}
\beta_1 \\ \beta_2 \\ \vdots \\ \beta_p
\end{bmatrix}, \hspace{10pt}
\boldsymbol{\varepsilon} = \begin{bmatrix}
\varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_n
\end{bmatrix}
\]</span> Desde este punto de vista, podemos plantear la suma de residuales al cuadrado como <span class="math display">\[\mathrm{RSS} = \boldsymbol{\varepsilon}^T\boldsymbol{\varepsilon}\]</span> Y la estimación se hace a través del método de mínimos cuadrados <span class="math display">\[
\begin{equation}
\begin{split}
\boldsymbol{\hat{\beta}} &amp; = \arg\min \boldsymbol{\varepsilon}^T\boldsymbol{\varepsilon} \\
&amp; = \arg\min \left( \bf{Y} - \bf{X} \boldsymbol{\beta} \right)^T \left( \bf{Y} - \bf{X} \boldsymbol{\beta} \right) \\
\end{split}
\end{equation}
\]</span> Al tomar la derivada de <span class="math inline">\(\mathrm{RSS}\)</span> con respecto a <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span> e igualar a cero, obtenemos la solución <span class="math display">\[
\boldsymbol{\hat{\beta}} = \left( \textbf{X}^T\bf{X}  \right)^{-1}\textbf{X}^T\bf{y}
\]</span></p>
</section>
<section id="valor-esperado-y-varianza" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="valor-esperado-y-varianza"><span class="header-section-number">5.2</span> Valor esperado y Varianza</h2>
<p>Los supuestos de homocedasticidad y no autocorrelación para los términos del error en el modelo, se pueden resumir estableciendo la matriz de varianzas y covarianzas del error como <span class="math display">\[\mathrm{Cov} \left( \boldsymbol{\varepsilon}\right) = \sigma^2 \mathbb{I}\]</span> Además, <span class="math inline">\(\mathrm{E}\left( \boldsymbol{\varepsilon}\right) = \bf{0}\)</span> y se asume que la matriz <span class="math inline">\(\bf{X}\)</span> no es estocástica.</p>
<p>Como consecuencia tenemos que</p>
<p><span class="math display">\[\mathrm{E} \left( \bf{{y}} \right) = \mathrm{E}\left( \boldsymbol{{\bf{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon}}}\right) = \mathrm{E} \left( \bf{X} \boldsymbol{\beta} \right) + \mathrm{E} \left( \boldsymbol{\varepsilon} \right)= \bf{X}\boldsymbol{\beta} + \bf{0} = \bf{X}\boldsymbol{\beta}\\
\]</span> <span class="math display">\[
\mathrm{Cov}\left( \bf{{y}}\right) = \mathrm{Cov}\left( \boldsymbol{{\bf{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon}}}\right) = \bf{0} + \mathrm{Cov} \left( \boldsymbol{\varepsilon} \right)= \sigma^2\mathbb{I}\\\]</span> Al aplicar propiedades del valor esperado y la varianza al vector de parámetros estimados (vector aleatorio) obtenemos</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
\mathrm{E} \left( \boldsymbol{\hat\beta}\right)
&amp; = \mathrm{E} \left( \left( \textbf{X}^T\bf{X}\right)^{-1} \textbf{X}^T\bf{y} \right) \\
&amp; = \left( \textbf{X}^T\bf{X}\right)^{-1} \textbf{X}^T \mathrm{E} \left( \bf{y} \right) \\
&amp; = \left( \textbf{X}^T \textbf{X}\right)^{-1} \textbf{X}^T \textbf{X} \boldsymbol{\beta} \\
&amp; = \mathbb{I}\boldsymbol{\beta} = \boldsymbol{\beta}
\end{split}
\end{equation}
\]</span> <span class="math display">\[
\begin{equation}
\begin{split}
\mathrm{Cov} \left( \boldsymbol{\hat\beta}\right)
&amp; = \mathrm{Cov} \left( \left( \textbf{X}^T\bf{X}\right)^{-1} \textbf{X}^T\bf{y} \right) \\
&amp; = \left( \textbf{X}^T\bf{X}\right)^{-1} \textbf{X}^T \mathrm{Cov} \left( \bf{y} \right)
\left( \left( \textbf{X}^T\bf{X}\right)^{-1} \textbf{X}^T \right)^T\\
&amp; = \left( \textbf{X}^T \textbf{X}\right)^{-1} \textbf{X}^T \left(\sigma^2 \mathbb{I}\right)
\textbf{X} \left( \textbf{X}^T\bf{X}\right)^{-1} \\
&amp; = \left( \textbf{X}^T \textbf{X}\right)^{-1} \textbf{X}^T
\textbf{X} \left( \textbf{X}^T\bf{X}\right)^{-1} \sigma^2 \\
&amp; = \left( \textbf{X}^T \textbf{X}\right)^{-1} \mathbb{I} \sigma^2 \\
&amp; = \left( \textbf{X}^T \textbf{X}\right)^{-1} \sigma^2 \\
\end{split}
\end{equation}
\]</span> Nota: Bajo los supuestos indicados (valor esperado cero, varianza constante y no autocorrelación), los estimadores de mínmios cuadrados son los de menor varianza entre todos los estimadores lineales insesgados (<strong>Teorema de Gauss-Markov</strong>)</p>
<p>Si queremos estimar la matriz de varianzas y covarianzas, debemos estimar la varianza del modelo, lo hacemos usando el estimador de mínimos cuadrados</p>
<p><span class="math display">\[\hat\sigma^2 = \frac{\boldsymbol{\varepsilon}^T \boldsymbol{\varepsilon}}{n-p-1}\]</span></p>
</section>
<section id="predicción" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="predicción"><span class="header-section-number">5.3</span> Predicción</h2>
<p>Al igual que en modelo de regresión lineal simple, una predicción para un conjunto de datos <em>nuevos</em> de las variables independientes, se obtiene al reemplezar dichos valores en la ecuación lineal.</p>
<p>Sea <span class="math inline">\(\textbf{x}_0\)</span> el vector que contiene los valores para los cuáles se quiere predecir la variable <span class="math inline">\(y\)</span>. en notación matricial tenemos</p>
<p><span class="math display">\[\hat{y} = \textbf{x}_0^T \boldsymbol{\hat \beta}\]</span> siendo, <span class="math inline">\(\textbf{x}_0^T = \begin{bmatrix} 1 &amp; x_{01} &amp; x_{02} &amp; \dots &amp; x_{0p} \end{bmatrix}\)</span></p>
<p>Si calculamos el valor de <span class="math inline">\(\hat{y}\)</span> para cada observación en el conjunto de datos <span class="math inline">\(\bf{X}\)</span></p>
<p><span class="math display">\[\hat{\bf{y}} = \textbf{X}\boldsymbol{\hat \beta} = \textbf{X}\left( \textbf{X}^T \textbf{X}\right)^{-1} \textbf{X}^T \bf{y} = \textbf{H}\bf{y}\]</span> La matriz <span class="math inline">\(\textbf{H} = \textbf{X}\left( \textbf{X}^T \textbf{X}\right)^{-1} \textbf{X}^T\)</span> se suele llamar matriz sombrero, ya que le “pone” un sombrero al vector <span class="math inline">\(\bf{y}\)</span></p>
<p>Con el último resultado, salta a la vista un hecho importante, las predicciones son <strong>combinaciones lineales</strong> de los datos observados. El modelo de regresión lineal es un caso particular de una clase de modelos más generales que son <strong>suavizadores lineales</strong> (hay otros modelos diferentes a los de regresión lineal que son suavizadores lineales)</p>
</section>
<section id="inferencia" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="inferencia"><span class="header-section-number">5.4</span> Inferencia</h2>
<p>Si queremos ir más allá de la sola estimación de los parámetros y predicción puntual, debemos asumir una distribución para el error del modelo y obtener la distribución de los estimadores. Bajo el supuesto de normalidad, que es el más común</p>
<p><span class="math display">\[\boldsymbol{\varepsilon} \sim N_n \left( \bf{0}, \sigma^2 \mathbb{I} \right) \Rightarrow
\textbf{y} \sim N_n \left( \bf{X}\boldsymbol{\beta}, \sigma^2 \mathbb{I} \right)
\]</span> Teniendo en cuenta que los estimadores son combinaciones lineales de <span class="math inline">\(\bf{y}\)</span>, y toda combinación lineal de distribuciones normales es también una distribución normal</p>
<p><span class="math display">\[\boldsymbol{\hat \beta}\sim N_{p+1} \left( \boldsymbol{\beta}, \left( \textbf{X}^T \textbf{X}\right)^{-1} \sigma^2 \right)\]</span> Con esto ya podemos calcular intervalos de confianza y hacer algunas pruebas de hipótesis</p>
</section>
<section id="pruebas-de-significancia" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="pruebas-de-significancia"><span class="header-section-number">5.5</span> Pruebas de significancia</h2>
<p>Cuando tenemos un modelo con múltiples variables, podemos hablar de la significancia global del modelo y de significancia individual de las variables.</p>
<p>La significancia global del modelo se usa para responder a la pregunta: ¿Al menos una de las variables es importante o explica en términos estadísticos a la variable <span class="math inline">\(y\)</span>? Para esto, usamos una prueba de hipótesis y un estadístico F (recordar por qué una distribución F en lugar de una distribución T, es valioso pero no fundamental para este curso)</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
H_0 &amp; : \beta_1 = \beta_2 =  \dots = \beta_p = 0 \\
H_a &amp; : \text{Al menos un beta es diferente de 0} \\ \\
F_{cal} &amp; = \frac{\left( \mathrm{TSS - RSS}\right)/p}{ \mathrm{RSS}/(n-p-1)}
\end{split}
\end{equation}
\]</span> Al hablar de significancia nos referimos a variables, pero las pruebas se hacen sobre los parámetros que acompañan dichas variables. Si un parámetro no es estadísticamente diferente de cero, entonces se puede concluir que los cambios de esa variable se ven anulados o no afectan a la variable <span class="math inline">\(y\)</span>, por esa razón, el <span class="math inline">\(\beta_0\)</span> no se incluye en la prueba de significancia.</p>
<p>Con un poco de manipulación algebraica se puede poner el <span class="math inline">\(F_{cal}\)</span> en términos del <span class="math inline">\(\mathrm{R^2}\)</span> del modelo (compruebe) <span class="math inline">\(F_{cal} = \frac{(n-p-1)\mathrm{R}^2}{p(1-\mathrm{R}^2)}\)</span></p>
<p>La prueba de significancia individual para las variables se plantea como</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
  H_0 &amp; : \beta_j = 0 \\
  H_a &amp; : \beta_j \neq 0 \\
  T_{cal} &amp; = \frac{\hat \beta_j}{\sqrt{\hat{\mathrm{Var}} (\hat \beta_j)}}
\end{split}
\end{equation}
\]</span> para algún <span class="math inline">\(j=1,2,3,...,p\)</span></p>
</section>
<section id="uso-de-r-para-los-cálculos" class="level2 page-columns page-full" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="uso-de-r-para-los-cálculos"><span class="header-section-number">5.6</span> Uso de <code>R</code> para los cálculos</h2>
<p>Trabajemos primero con un conjunto de datos simulados para observar algunos detalles de cálculo en el modelo de regresión lineal múltiple</p>
<p>Consideremos el modelo lineal “real”</p>
<p><span class="math display">\[y = 1 + 2x_1 + 3x_2 + 4x_3 + \varepsilon\]</span> Simulemos 100 observaciones de cada variable independiente (generadas uniformemente entre 0 y 1) y un error normalmente distribuido con media de 0 y desviación estándar de 1.5</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-1_2863ae87ce168aab055209d5600b3c95">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>x3 <span class="sc">+</span> error</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">var_dep =</span> y, <span class="at">var1 =</span> x1, <span class="at">var2 =</span> x2, <span class="at">var3 =</span> x3)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>datos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 4
   var_dep   var1   var2   var3
     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1    4.19 0.700  0.481  0.293 
 2    1.79 0.0935 0.314  0.0935
 3    2.88 0.0119 0.0643 0.345 
 4    7.80 0.592  0.890  0.215 
 5    6.08 0.492  0.787  0.721 
 6    5.46 0.0202 0.164  0.927 
 7    5.13 0.573  0.443  0.565 
 8    4.94 0.166  0.429  0.831 
 9    4.54 0.359  0.240  0.556 
10    4.66 0.346  0.481  0.115 
# ℹ 90 more rows</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>Ajustamos un modelo de regresión lineal usando las funciones de <code>R</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;como haríamos en la práctica, no es necesario usar las ecuaciones matriciales que hemos visto. Ni siquiera <code>R</code> ajusta el modelo con esas ecuaciones matriciales internamente (¿Por qué?)</p></li></div></div>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-2_cc95ae2ba9286279aab9355ab10ced91">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> var_dep <span class="sc">~</span> var1 <span class="sc">+</span> var2 <span class="sc">+</span> var3, <span class="at">data =</span> datos)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = var_dep ~ var1 + var2 + var3, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5503 -0.9438  0.0341  1.0381  3.2040 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.02071    0.50151   0.041    0.967    
var1         2.77634    0.56757   4.892 4.02e-06 ***
var2         3.16818    0.54805   5.781 9.23e-08 ***
var3         4.67855    0.53282   8.781 6.17e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.543 on 96 degrees of freedom
Multiple R-squared:  0.5838,    Adjusted R-squared:  0.5708 
F-statistic: 44.89 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Al aplicar la función <code>lm</code> se guardan varios resultados, podemos acceder por el nombre de cada uno en el objeto <code>modelo1</code> o en el objeto <code>summary(modelo1)</code></p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-3_b763ecb06b23b2912263f856741b1432">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(modelo1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">summary</span>(modelo1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
</div>
<p>Podemos imprimir los coeficientes estimados o el <span class="math inline">\(\mathrm{R}^2\)</span></p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-4_d3cec18bdbeb5d66a8622f8e91d724e5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>modelo1<span class="sc">$</span>coefficients</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        var1        var2        var3 
 0.02071457  2.77634472  3.16818077  4.67855453 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1)<span class="sc">$</span>r.squared</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5838244</code></pre>
</div>
</div>
<p>La matriz de varianzas y covarianzas de los estimadores se obtiene con</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-5_b7b943e29e7d84e0f7cada37dfc6f960">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(modelo1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)        var1        var2        var3
(Intercept)   0.2515144 -0.14854787 -0.15860673 -0.14759946
var1         -0.1485479  0.32213475  0.01027060 -0.01353928
var2         -0.1586067  0.01027060  0.30036354  0.00552749
var3         -0.1475995 -0.01353928  0.00552749  0.28389997</code></pre>
</div>
</div>
<p>Es buen ejercicio intentar obtener estos resultados a partir de las ecuaciones matriciales del modelo</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-6_4121866d187dc34fae068401a0fca975">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matriz X</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mx <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,n), x1, x2, x3)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>beta_est <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(mx)<span class="sc">%*%</span>mx)<span class="sc">%*%</span><span class="fu">t</span>(mx)<span class="sc">%*%</span>y</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> mx<span class="sc">%*%</span><span class="fu">solve</span>(<span class="fu">t</span>(mx)<span class="sc">%*%</span>mx)<span class="sc">%*%</span><span class="fu">t</span>(mx)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>beta_est</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
   0.02071457
x1 2.77634472
x2 3.16818077
x3 4.67855453</code></pre>
</div>
</div>
<p>Predicciones, residuales, matriz de varianzas y covarianzas</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-7_5cc2d6dba8ab5aad030038d5a4e81ab3">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y_est <span class="ot">&lt;-</span> H<span class="sc">%*%</span>y</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> y <span class="sc">-</span> y_est</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sigma2_est <span class="ot">&lt;-</span> <span class="fu">sum</span>(res<span class="sc">*</span>res)<span class="sc">/</span>(n<span class="dv">-3-1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>cov_beta <span class="ot">&lt;-</span> sigma2_est<span class="sc">*</span>(<span class="fu">solve</span>(<span class="fu">t</span>(mx)<span class="sc">%*%</span>mx))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       V1          
 Min.   :-4.55030  
 1st Qu.:-0.94376  
 Median : 0.03413  
 Mean   : 0.00000  
 3rd Qu.: 1.03810  
 Max.   : 3.20398  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(sigma2_est) <span class="co"># Residual standard error</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.543416</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cov_beta</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           intercepto        var1        var2        var3
intercepto  0.2515144 -0.14854787 -0.15860673 -0.14759946
var1       -0.1485479  0.32213475  0.01027060 -0.01353928
var2       -0.1586067  0.01027060  0.30036354  0.00552749
var3       -0.1475995 -0.01353928  0.00552749  0.28389997</code></pre>
</div>
</div>
<p>El <span class="math inline">\(\mathrm{R^2}\)</span> del modelo es por definición, <span class="math inline">\(\mathrm{R^2} = 1- \frac{\mathrm{SSE}}{\mathrm{SST}}\)</span>. El cálculo directo en <code>R</code> sería</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-8_bd47e57b448d82618282b8ee5404ad93">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(res<span class="sc">*</span>res)<span class="sc">/</span><span class="fu">sum</span>((y<span class="sc">-</span><span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>r2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5838244</code></pre>
</div>
</div>
<p>Calculemos el error estándar, valor de la distribución <span class="math inline">\(t\)</span> y valor <span class="math inline">\(p\)</span> para alguno de los <span class="math inline">\(\hat\beta_i\)</span></p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-9_70bf22b024219e521066a49861329dcf">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para el beta_1 que acompaña a la variable 1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>s.eb1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(cov_beta[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="co"># ¿por qué se elige el segundo valor en la diagonal?</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> beta_est[<span class="dv">2</span>]<span class="sc">/</span>s.eb1</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>p.b1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="at">q =</span> tb1, <span class="at">df =</span> n<span class="dv">-3-1</span>, <span class="at">lower.tail =</span> F) <span class="co"># ¿por qué se multiplica por 2?</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>s.eb1; tb1; p.b1 </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5675692</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.891641</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.019829e-06</code></pre>
</div>
</div>
<p>El valor de la distribución F para la significancia global es</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-10_c6c14ded1992e563c1b571405968efac">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>f_cal <span class="ot">&lt;-</span> (n<span class="dv">-3-1</span>)<span class="sc">*</span>r2<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>r2))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>f_cal</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.89062</code></pre>
</div>
</div>
<p>El valor p es</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-11_ee33a2b1f8aebe076b3bece45896ea93">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Por qué en este caso no se multiplica por 2?</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>p.sig.global <span class="ot">&lt;-</span> <span class="fu">pf</span>(<span class="at">q =</span> f_cal, <span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> n<span class="dv">-3-1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>p.sig.global</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.220991e-18</code></pre>
</div>
</div>
<p>Compare todos los resultados con los entregados de forma directa por la función <code>lm</code></p>
<p>Algo que se debe señalar, es el valor relativamente bajo del <span class="math inline">\(\mathrm{R}^2\)</span>. Un <span class="math inline">\(\mathrm{R}^2\)</span> bajo no implica necesariamente que el modelo sea errado. En este caso, estamos ajustando sobre la verdadera forma del modelo “real” por lo que el modelo planteado no podría estar equivocado. Simulemos otro conjunto de datos en el que el error tenga una menor varianza o desviación estándar.</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-12_b465cbe2efc80cb799bbadf2255d9250">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>x3 <span class="sc">+</span> error</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">var_dep =</span> y, <span class="at">var1 =</span> x1, <span class="at">var2 =</span> x2, <span class="at">var3 =</span> x3)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> var_dep <span class="sc">~</span> var1 <span class="sc">+</span> var2 <span class="sc">+</span> var3, <span class="at">data =</span> datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare el valor del <span class="math inline">\(\mathrm R^2\)</span> para cada caso. ¿Qué puede concluir?</p>
<div class="cell" data-hash="reg-multiple_cache/html/unnamed-chunk-13_3e6055ce5080300e1a8e00066d721a94">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2)<span class="sc">$</span>r.squared</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9135621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1)<span class="sc">$</span>r.squared</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5838244</code></pre>
</div>
</div>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./reg-simple.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresión lineal simple</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Referencias</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>